针对prisma-chat项目建立全链路监控系统的需求分析如下：

1. 功能需求
1.1 前端错误追踪
- 集成Sentry SDK实现前端错误自动捕获
- 支持错误分类（JS异常、资源加载错误、API请求错误等）
- 需记录错误上下文信息（用户ID、设备信息、操作路径等）

1.2 后端日志分析
- 部署ELK(Elasticsearch+Logstash+Kibana)技术栈
- 实现结构化日志采集（包含请求ID、接口耗时、错误码等关键字段）
- 支持日志多维度检索（时间范围、服务名称、错误级别等）

1.3 全链路追踪
- 需实现请求ID贯穿前后端
- 关键业务节点需打点记录（如WebSocket连接建立、消息发送等）
- 错误告警需关联相关日志和链路数据

2. 非功能需求
2.1 性能指标
- 错误数据上报延迟<1s
- 日志查询响应时间<3s(百万级数据量)
- 系统资源占用率<15%

2.2 可靠性
- 日志存储至少保留30天
- 支持每日日志自动归档
- 关键错误需实现分级告警（邮件/短信）

3. 技术约束
3.1 前端部分
- 需兼容现有React+TypeScript技术栈
- 错误上报不得影响主业务流程

3.2 后端部分
- 需适配NestJS日志体系
- 日志采集需兼容PrismaORM输出
- 需支持Redis缓存日志的场景

4. 数据指标
- 错误定位时间缩短70%（从平均30分钟降至9分钟）
- 系统可用性提升至99.95%
- 关键业务异常发现率>95%

5. 实施建议
- 采用渐进式接入策略，先核心模块后全量
- 需建立监控看板展示关键指标
- 需编写详细的运维手册